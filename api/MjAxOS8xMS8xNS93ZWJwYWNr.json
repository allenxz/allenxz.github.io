{"title":"简单的webpack配置","date":"2019-11-15T00:55:36.171Z","thumbnail":"https://s2.ax1x.com/2019/11/15/MUfqkF.md.jpg","link":"2019/11/15/webpack","updated":"2019-11-15T07:58:32.032Z","content":"<h2 id=\"基本配置\">基本配置<a href=\"2019/11/15/webpack#基本配置\"></a></h2><ol>\n<li><p>进入项目文件夹</p>\n</li>\n<li><p>确认安装了node.js</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node -v</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>初始化npm</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm init -y</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>安装webpack</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install webpack webpack-cli</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>安装<code>html-webpack-pligin</code>和<code>webpack-dev-server</code></p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install html-webpack-plugin</span><br><span class=\"line\">npm install webpack-dev-server</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>新建webpack配置文件</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">'path'</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> HtmlWebpackPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">'html-webpack-plugin'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">  mode: <span class=\"string\">'development'</span>,</span><br><span class=\"line\">  entry: path.join(__dirname, <span class=\"string\">'src'</span>, <span class=\"string\">'index.js'</span>),</span><br><span class=\"line\">  output: &#123;</span><br><span class=\"line\">    filename: <span class=\"string\">'bundle.js'</span>,</span><br><span class=\"line\">    path: path.join(__dirname, <span class=\"string\">'dist'</span>)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  plugins: [</span><br><span class=\"line\">    <span class=\"keyword\">new</span> HtmlWebpackPlugin(&#123;</span><br><span class=\"line\">      template: path.join(__dirname, <span class=\"string\">'src'</span>, <span class=\"string\">'index.html'</span>),</span><br><span class=\"line\">      filename: <span class=\"string\">'index.html'</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ],</span><br><span class=\"line\">  devServer: &#123;</span><br><span class=\"line\">    port: <span class=\"number\">3000</span>,</span><br><span class=\"line\">    contentBase: path.join(__dirname, <span class=\"string\">'dist'</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>在<code>package.json</code>的<code>scripts</code>项中添加脚本命令</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">\"scripts\"</span>: &#123;</span><br><span class=\"line\">  <span class=\"string\">\"test\"</span>: <span class=\"string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>,</span><br><span class=\"line\">+ <span class=\"string\">\"build\"</span>: <span class=\"string\">\"webpack\"</span>,</span><br><span class=\"line\">+ <span class=\"string\">\"dev\"</span>: <span class=\"string\">\"webpack-dev-server\"</span></span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>启动编译项目</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm run dev</span><br></pre></td></tr></table></div></figure>\n\n</li>\n</ol>\n<h2 id=\"添加babel\">添加babel<a href=\"2019/11/15/webpack#添加babel\"></a></h2><ol>\n<li><p>安装babel相关包</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install @babel/core @babel/preset-env babel-loader</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>添加babel配置文件</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir .babelrc</span><br></pre></td></tr></table></div></figure>\n\n<p>在<code>.babelrc</code>中添加</p>\n<figure class=\"highlight json\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"attr\">\"presets\"</span>: [<span class=\"string\">\"@babel/preset-env\"</span>]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>修改<code>webpack.config.js</code></p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">+ <span class=\"built_in\">module</span>: &#123;</span><br><span class=\"line\">+   rules: [</span><br><span class=\"line\">+     &#123;</span><br><span class=\"line\">+       test: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">+       loader: [<span class=\"string\">'babel-loader'</span>],</span><br><span class=\"line\">+       include: path.join(__dirname, <span class=\"string\">'src'</span>),</span><br><span class=\"line\">+       exclude: <span class=\"regexp\">/node_modules/</span></span><br><span class=\"line\">+     &#125;</span><br><span class=\"line\">+   ]</span><br><span class=\"line\">+ &#125;,</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n</li>\n</ol>\n<h2 id=\"配置生产环境\">配置生产环境<a href=\"2019/11/15/webpack#配置生产环境\"></a></h2><ol>\n<li><p>新建生产环境下的配置文件</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir webpack.prod.js</span><br></pre></td></tr></table></div></figure>\n\n<p>内容为：</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> path = <span class=\"built_in\">require</span>(<span class=\"string\">'path'</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> HtmlWebpackPlugin = <span class=\"built_in\">require</span>(<span class=\"string\">'html-webpack-plugin'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">module</span>.exports = &#123;</span><br><span class=\"line\">  mode: <span class=\"string\">'production'</span>, </span><br><span class=\"line\">  entry: path.join(__dirname, <span class=\"string\">'src'</span>, <span class=\"string\">'index.js'</span>),</span><br><span class=\"line\">  output: &#123;</span><br><span class=\"line\">    filename: <span class=\"string\">'bundle.[contenthash].js'</span>,</span><br><span class=\"line\">    path: path.join(__dirname, <span class=\"string\">'dist'</span>)</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"built_in\">module</span>: &#123;</span><br><span class=\"line\">    rules: [</span><br><span class=\"line\">      &#123;</span><br><span class=\"line\">        test: <span class=\"regexp\">/\\.js$/</span>,</span><br><span class=\"line\">        loader: [<span class=\"string\">'babel-loader'</span>],</span><br><span class=\"line\">        include: path.join(__dirname, <span class=\"string\">'src'</span>),</span><br><span class=\"line\">        exclude: <span class=\"regexp\">/node_modules/</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  plugins: [</span><br><span class=\"line\">    <span class=\"keyword\">new</span> HtmlWebpackPlugin(&#123;</span><br><span class=\"line\">      template: path.join(__dirname, <span class=\"string\">'src'</span>, <span class=\"string\">'index.html'</span>),</span><br><span class=\"line\">      filename: <span class=\"string\">'index.html'</span></span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n</li>\n<li><p>在<code>package.json</code>修改启动的脚本命令</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">\"scripts\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"test\"</span>: <span class=\"string\">\"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\"</span>,</span><br><span class=\"line\">-   <span class=\"string\">\"build\"</span>: <span class=\"string\">\"webpack\"</span>,   </span><br><span class=\"line\">+   <span class=\"string\">\"build\"</span>: <span class=\"string\">\"webpack --config webpack.prod.js\"</span>,</span><br><span class=\"line\">    <span class=\"string\">\"dev\"</span>: <span class=\"string\">\"webpack-dev-server\"</span></span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></div></figure>\n\n</li>\n</ol>\n","prev":{"title":"性能优化","link":"2019/11/15/Performance-optimization"},"next":{"title":"Git 相关","link":"2019/11/14/git"},"plink":"http://allenxz.github.io/2019/11/15/webpack/","toc":[{"title":"基本配置","id":"基本配置","index":"1"},{"title":"添加babel","id":"添加babel","index":"2"},{"title":"配置生产环境","id":"配置生产环境","index":"3"}]}