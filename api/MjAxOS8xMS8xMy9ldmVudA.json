{"title":"JavaScript —— 事件","date":"2019-11-13T07:40:34.897Z","thumbnail":"https://s2.ax1x.com/2019/11/13/MGTB4J.md.jpg","link":"2019/11/13/event","updated":"2019-11-13T13:01:54.593Z","content":"<h2 id=\"事件绑定\">事件绑定<a href=\"2019/11/13/event#事件绑定\"></a></h2><figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// 通用的事件绑定函数</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">bindEvent</span>(<span class=\"params\">elem, type, selector, fn</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (fn == <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">    fn = selector</span><br><span class=\"line\">    selector = <span class=\"literal\">null</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  elem.addEventListener(type, event =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> target = event.target</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (selector) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 代理绑定</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (target.matches(selector))&#123;</span><br><span class=\"line\">        fn.call(target, event)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"comment\">// 普通绑定</span></span><br><span class=\"line\">      fn.call(target, event)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n<h2 id=\"事件冒泡\">事件冒泡<a href=\"2019/11/13/event#事件冒泡\"></a></h2><p>事件会沿着DOM树型结构逐层往上冒泡。</p>\n<p>通过<code>event.stopPropagation</code>阻止继续向上冒泡。</p>\n<p>应用场景：代理</p>\n<h2 id=\"事件代理\">事件代理<a href=\"2019/11/13/event#事件代理\"></a></h2><p>例子：点击a标签返回其标签内的内容</p>\n<p>html：</p>\n<figure class=\"highlight html\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">id</span>=<span class=\"string\">\"div\"</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span>a1<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span>a2<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span>a3<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span>a4<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">\"#\"</span>&gt;</span>a5<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">br</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span><br></pre></td></tr></table></div></figure>\n\n<p>JS：</p>\n<figure class=\"highlight javascript\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> div = <span class=\"built_in\">document</span>.getElementById(<span class=\"string\">'div'</span>)</span><br><span class=\"line\">bindEvent(div, <span class=\"string\">'click'</span>, <span class=\"string\">'a'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">event</span>) </span>&#123;</span><br><span class=\"line\">  event.preventDefault()</span><br><span class=\"line\">  alert(<span class=\"keyword\">this</span>.innerHTML)</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></div></figure>\n\n","prev":{"title":"JavaScript —— Ajax","link":"2019/11/14/ajax"},"next":{"title":"JavaScript —— DOM & BOM","link":"2019/11/13/DOM"},"plink":"http://yoursite.com/2019/11/13/event/","toc":[{"title":"事件绑定","id":"事件绑定","index":"1"},{"title":"事件冒泡","id":"事件冒泡","index":"2"},{"title":"事件代理","id":"事件代理","index":"3"}]}